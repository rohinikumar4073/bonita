<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for js/editor/whiteboard/component-scope-builder.service.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../prettify.css">
    <link rel="stylesheet" href="../../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header high">
    <h1>Code coverage report for <span class="entity">js/editor/whiteboard/component-scope-builder.service.js</span></h1>
    <h2>
        Statements: <span class="metric">100% <small>(17 / 17)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">100% <small>(5 / 5)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">100% <small>(7 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">100% <small>(15 / 15)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">js/editor/whiteboard/</a> &#187; component-scope-builder.service.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict'; /**
               * Copyright (C) 2015 Bonitasoft S.A.
               * Bonitasoft, 32 rue Gustave Eiffel - 38000 Grenoble
               * This program is free software: you can redistribute it and/or modify
               * it under the terms of the GNU General Public License as published by
               * the Free Softw≈ìare Foundation, either version 2.0 of the License, or
               * (at your option) any later version.
               * This program is distributed in the hope that it will be useful,
               * but WITHOUT ANY WARRANTY; without even the implied warranty of
               * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
               * GNU General Public License for more details.
               * You should have received a copy of the GNU General Public License
               * along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.
               */
/**
 * Initialises a scope for component directive
 *
 * Create a new scope with a properties object derived from user entered propertyValues.
 * This allow to bind propertyValues to widget properties and keep a WYSWYG approach in editor while editing widget properties
 */
angular.module('bonitasoft.designer.editor.whiteboard').factory('componentScopeBuilder', function (dataFilter) {
&nbsp;
  'use strict';
&nbsp;
  var build = function (scope) {
    var componentScope = scope.$new(true);
&nbsp;
    componentScope.environment = {};
    componentScope.environment.editor = { 
      pageId: scope.editor &amp;&amp; scope.editor.page &amp;&amp; scope.editor.page.id };
&nbsp;
    componentScope.environment.component = scope.component.$$widget;
&nbsp;
    // Keep in sync propertyValues and injected properties in widget
    componentScope.properties = {};
    angular.forEach(scope.component.propertyValues, function (value, key) {
      scope.$watch('component.propertyValues["' + key + '"].value', function () {
        // we extract the corresponding property descriptor from widget (using filter)
        // in order to get its type  (using map)
        var propertyType = scope.component.$$widget.properties.filter(function (param) {return param.name === key;}).
        map(function (param) {return param.type;}).pop() || 'text';
&nbsp;
        componentScope.properties[key] = dataFilter(scope.component.propertyValues[key], propertyType);});});
&nbsp;
&nbsp;
&nbsp;
    // utility function, available in widget's template, to iterate over a range
    componentScope.range = function (size) {return new Array(size);};
&nbsp;
    return componentScope;};
&nbsp;
&nbsp;
  return { 
    build: build };});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudC1zY29wZS1idWlsZGVyLnNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFvQkEsUUFBUSxNQUFSLENBQWUsdUNBQWYsRUFBd0QsT0FBeEQsQ0FBZ0UsdUJBQWhFLEVBQXlGLFVBQVMsVUFBVCxFQUFxQjs7QUFFNUc7O0FBRUEsTUFBSSxRQUFRLFVBQVMsS0FBVCxFQUFnQjtBQUMxQixRQUFJLGlCQUFpQixNQUFNLElBQU4sQ0FBVyxJQUFYLENBQXJCOztBQUVBLG1CQUFlLFdBQWYsR0FBNkIsRUFBN0I7QUFDQSxtQkFBZSxXQUFmLENBQTJCLE1BQTNCLEdBQW9DO0FBQ2xDLGNBQVEsTUFBTSxNQUFOLElBQWdCLE1BQU0sTUFBTixDQUFhLElBQTdCLElBQXFDLE1BQU0sTUFBTixDQUFhLElBQWIsQ0FBa0IsRUFEN0IsRUFBcEM7O0FBR0EsbUJBQWUsV0FBZixDQUEyQixTQUEzQixHQUF1QyxNQUFNLFNBQU4sQ0FBZ0IsUUFBdkQ7OztBQUdBLG1CQUFlLFVBQWYsR0FBNEIsRUFBNUI7QUFDQSxZQUFRLE9BQVIsQ0FBZ0IsTUFBTSxTQUFOLENBQWdCLGNBQWhDLEVBQWdELFVBQVMsS0FBVCxFQUFnQixHQUFoQixFQUFxQjtBQUNuRSxZQUFNLE1BQU4sQ0FBYSwrQkFBK0IsR0FBL0IsR0FBcUMsVUFBbEQsRUFBOEQsWUFBVzs7O0FBR3ZFLFlBQUksZUFBZSxNQUFNLFNBQU4sQ0FBZ0IsUUFBaEIsQ0FBeUIsVUFBekIsQ0FBb0MsTUFBcEMsQ0FBMkMsVUFBQyxLQUFELFVBQVcsTUFBTSxJQUFOLEtBQWUsR0FBMUIsRUFBM0M7QUFDaEIsV0FEZ0IsQ0FDWixVQUFDLEtBQUQsVUFBVyxNQUFNLElBQWpCLEVBRFksRUFDVyxHQURYLE1BQ29CLE1BRHZDOztBQUdBLHVCQUFlLFVBQWYsQ0FBMEIsR0FBMUIsSUFBaUMsV0FBVyxNQUFNLFNBQU4sQ0FBZ0IsY0FBaEIsQ0FBK0IsR0FBL0IsQ0FBWCxFQUFpRCxZQUFqRCxDQUFqQyxDQUNELENBUEQsRUFRRCxDQVREOzs7OztBQVlBLG1CQUFlLEtBQWYsR0FBdUIsVUFBQyxJQUFELFVBQVUsSUFBSSxLQUFKLENBQVUsSUFBVixDQUFWLEVBQXZCOztBQUVBLFdBQU8sY0FBUCxDQUNELENBMUJEOzs7QUE0QkEsU0FBTztBQUNMLFdBQU8sS0FERixFQUFQLENBR0QsQ0FuQ0QiLCJmaWxlIjoiY29tcG9uZW50LXNjb3BlLWJ1aWxkZXIuc2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChDKSAyMDE1IEJvbml0YXNvZnQgUy5BLlxuICogQm9uaXRhc29mdCwgMzIgcnVlIEd1c3RhdmUgRWlmZmVsIC0gMzgwMDAgR3Jlbm9ibGVcbiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuICogdGhlIEZyZWUgU29mdHfFk2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAyLjAgb2YgdGhlIExpY2Vuc2UsIG9yXG4gKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlXG4gKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uXG4gKi9cbi8qKlxuICogSW5pdGlhbGlzZXMgYSBzY29wZSBmb3IgY29tcG9uZW50IGRpcmVjdGl2ZVxuICpcbiAqIENyZWF0ZSBhIG5ldyBzY29wZSB3aXRoIGEgcHJvcGVydGllcyBvYmplY3QgZGVyaXZlZCBmcm9tIHVzZXIgZW50ZXJlZCBwcm9wZXJ0eVZhbHVlcy5cbiAqIFRoaXMgYWxsb3cgdG8gYmluZCBwcm9wZXJ0eVZhbHVlcyB0byB3aWRnZXQgcHJvcGVydGllcyBhbmQga2VlcCBhIFdZU1dZRyBhcHByb2FjaCBpbiBlZGl0b3Igd2hpbGUgZWRpdGluZyB3aWRnZXQgcHJvcGVydGllc1xuICovXG5hbmd1bGFyLm1vZHVsZSgnYm9uaXRhc29mdC5kZXNpZ25lci5lZGl0b3Iud2hpdGVib2FyZCcpLmZhY3RvcnkoJ2NvbXBvbmVudFNjb3BlQnVpbGRlcicsIGZ1bmN0aW9uKGRhdGFGaWx0ZXIpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIGJ1aWxkID0gZnVuY3Rpb24oc2NvcGUpIHtcbiAgICB2YXIgY29tcG9uZW50U2NvcGUgPSBzY29wZS4kbmV3KHRydWUpO1xuXG4gICAgY29tcG9uZW50U2NvcGUuZW52aXJvbm1lbnQgPSB7fTtcbiAgICBjb21wb25lbnRTY29wZS5lbnZpcm9ubWVudC5lZGl0b3IgPSB7XG4gICAgICBwYWdlSWQ6IHNjb3BlLmVkaXRvciAmJiBzY29wZS5lZGl0b3IucGFnZSAmJiBzY29wZS5lZGl0b3IucGFnZS5pZFxuICAgIH07XG4gICAgY29tcG9uZW50U2NvcGUuZW52aXJvbm1lbnQuY29tcG9uZW50ID0gc2NvcGUuY29tcG9uZW50LiQkd2lkZ2V0O1xuXG4gICAgLy8gS2VlcCBpbiBzeW5jIHByb3BlcnR5VmFsdWVzIGFuZCBpbmplY3RlZCBwcm9wZXJ0aWVzIGluIHdpZGdldFxuICAgIGNvbXBvbmVudFNjb3BlLnByb3BlcnRpZXMgPSB7fTtcbiAgICBhbmd1bGFyLmZvckVhY2goc2NvcGUuY29tcG9uZW50LnByb3BlcnR5VmFsdWVzLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICBzY29wZS4kd2F0Y2goJ2NvbXBvbmVudC5wcm9wZXJ0eVZhbHVlc1tcIicgKyBrZXkgKyAnXCJdLnZhbHVlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIHdlIGV4dHJhY3QgdGhlIGNvcnJlc3BvbmRpbmcgcHJvcGVydHkgZGVzY3JpcHRvciBmcm9tIHdpZGdldCAodXNpbmcgZmlsdGVyKVxuICAgICAgICAvLyBpbiBvcmRlciB0byBnZXQgaXRzIHR5cGUgICh1c2luZyBtYXApXG4gICAgICAgIHZhciBwcm9wZXJ0eVR5cGUgPSBzY29wZS5jb21wb25lbnQuJCR3aWRnZXQucHJvcGVydGllcy5maWx0ZXIoKHBhcmFtKSA9PiBwYXJhbS5uYW1lID09PSBrZXkpXG4gICAgICAgICAgLm1hcCgocGFyYW0pID0+IHBhcmFtLnR5cGUpLnBvcCgpIHx8ICd0ZXh0JztcblxuICAgICAgICBjb21wb25lbnRTY29wZS5wcm9wZXJ0aWVzW2tleV0gPSBkYXRhRmlsdGVyKHNjb3BlLmNvbXBvbmVudC5wcm9wZXJ0eVZhbHVlc1trZXldLCAgcHJvcGVydHlUeXBlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gdXRpbGl0eSBmdW5jdGlvbiwgYXZhaWxhYmxlIGluIHdpZGdldCdzIHRlbXBsYXRlLCB0byBpdGVyYXRlIG92ZXIgYSByYW5nZVxuICAgIGNvbXBvbmVudFNjb3BlLnJhbmdlID0gKHNpemUpID0+IG5ldyBBcnJheShzaXplKTtcblxuICAgIHJldHVybiBjb21wb25lbnRTY29wZTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGJ1aWxkOiBidWlsZFxuICB9O1xufSk7XG4iXX0=</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Jun 28 2016 07:45:53 GMT+0530 (IST)</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
