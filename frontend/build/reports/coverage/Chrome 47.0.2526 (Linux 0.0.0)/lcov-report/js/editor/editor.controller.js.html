<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for js/editor/editor.controller.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../prettify.css">
    <link rel="stylesheet" href="../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header medium">
    <h1>Code coverage report for <span class="entity">js/editor/editor.controller.js</span></h1>
    <h2>
        Statements: <span class="metric">77.27% <small>(85 / 110)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">82.14% <small>(23 / 28)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">59.38% <small>(19 / 32)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">77.27% <small>(85 / 110)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">js/editor/</a> &#187; editor.controller.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11</span>
<span class="cline-any cline-yes">11</span>
<span class="cline-any cline-yes">11</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict'; /**
               * Copyright (C) 2015 Bonitasoft S.A.
               * Bonitasoft, 32 rue Gustave Eiffel - 38000 Grenoble
               * This program is free software: you can redistribute it and/or modify
               * it under the terms of the GNU General Public License as published by
               * the Free Software Foundation, either version 2.0 of the License, or
               * (at your option) any later version.
               * This program is distributed in the hope that it will be useful,
               * but WITHOUT ANY WARRANTY; without even the implied warranty of
               * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
               * GNU General Public License for more details.
               * You should have received a copy of the GNU General Public License
               * along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.
               */
/**
 * The editor controller. It handles the palette, the resolution changes, the selections, and provides
 * common functions to the directives used inside the page.
 */
&nbsp;
angular.module('bonitasoft.designer.editor').controller('EditorCtrl', function ($scope, $state, $stateParams, $window, artifactRepo, resolutions, artifact, mode, arrays, componentUtils, keymaster, $uibModal, utils, whiteboardService) {
&nbsp;
  'use strict';
&nbsp;
  /**
   * Names the current browsing context
   */
  $window.name = 'editor';
&nbsp;
  /**
   * The editor mode
   */
  $scope.mode = mode || <span class="branch-1 cbranch-no" title="branch not covered" >'page';</span>
  /**
   * The root container of the editor, always present. If there is no page loaded, then we build an empty one.
   * It initially contains a single row, and may not contain less than a row. The counters are used by e2e tests.
   */
  $scope.page = artifact;
&nbsp;
  $scope.resolution = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return resolutions.selected();}</span>;
&nbsp;
&nbsp;
  /**
   * Adding DEL keyboard shortcut
   */
  keymaster('del', <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    if (!$scope.currentComponent) {</span>
<span class="cstat-no" title="statement not covered" >      return;}</span>
&nbsp;
&nbsp;
<span class="cstat-no" title="statement not covered" >    $scope.$apply(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >      $scope.removeCurrentComponent();}</span>);});
&nbsp;
&nbsp;
&nbsp;
  keymaster('right', <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    moveSelection(+1);}</span>);
&nbsp;
&nbsp;
  keymaster('left', <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    moveSelection(-1);}</span>);
&nbsp;
&nbsp;
  keymaster('ctrl+s', <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    $scope.$apply(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >      $scope.save();}</span>);
&nbsp;
    // prevent default browser action
<span class="cstat-no" title="statement not covered" >    return false;}</span>);
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >  function moveSelection(offset) {</span>
<span class="cstat-no" title="statement not covered" >    var components = componentUtils.getVisibleComponents($scope.page);</span>
<span class="cstat-no" title="statement not covered" >    var index = components.indexOf($scope.currentComponent) + offset;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    index = utils.clamp(0, index, components.length - 1);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    $scope.$apply(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >      $scope.selectComponent(components[index]);}</span>);}
&nbsp;
&nbsp;
&nbsp;
  $scope.$on('$destroy', <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    keymaster.unbind('del');</span>
<span class="cstat-no" title="statement not covered" >    keymaster.unbind('right');</span>
<span class="cstat-no" title="statement not covered" >    keymaster.unbind('left');}</span>);
&nbsp;
&nbsp;
  /**
   * Returns the CSS classes that must be set on a component in the editor to reflect its width and the currently
   * selected resolution. It returns an array containing the columnClass of the component, as well as
   * component-selected if the current selection is the given component.
   * Note that this function is called for a component of type 'widget' or of type 'container'.
   */
  $scope.componentClasses = function (component) {
    var result = [componentUtils.column.className(component)];
&nbsp;
    return result;};
&nbsp;
&nbsp;
  /**
   * Function called when we want the current selection to be a row of a container. Selecting a row of a container
   * allows displaying the palette, in order to add a widget or container component to the selected row, to delete
   * or move the selected row, or to add a new row before or after the selected row.
   * Selecting a row automatically unselects the previously selected row or component or tab.
   * @param container the container directly containing the row to select
   * @param row the row to select
   * @param event the event, used to prevent the click to propagate to parent elements
   */
  $scope.selectRow = function (container, row, event) {
&nbsp;
    $scope.currentComponent = null;
    $scope.currentContainerRow = { 
      row: row, 
      container: container };
&nbsp;
    if (event) {
      event.stopPropagation();}};
&nbsp;
&nbsp;
&nbsp;
  /**
   * Drag and drop an item, it means re-attach this item
   * @param  {Object} element Widget already configured
   * @return {void}
   */
  $scope.dropElement = function (element) {
    $scope.currentComponent = element;
    element.$$parentContainerRow = $scope.currentContainerRow;
    $scope.currentContainerRow.row.push(element);
    componentUtils.column.computeSizeItemInRow($scope.currentContainerRow.row);};
&nbsp;
&nbsp;
  /**
   * move a component to a specific position inside the current active row
   * @param  {int}    componentIndex new index for component
   * @param  {Object} component      a component
   */
  $scope.moveAtPosition = <span class="fstat-no" title="function not covered" >function (componentIndex, component) {</span>
<span class="cstat-no" title="statement not covered" >    arrays.moveAtPosition(component, componentIndex, $scope.currentContainerRow.row);</span>
<span class="cstat-no" title="statement not covered" >    $scope.selectComponent(component);}</span>;
&nbsp;
&nbsp;
  /**
   * Function called when we want the current selection to be a widget component or a container component. Selecting
   * a widget component allows displaying the editor for this widget component, and the controls used to move the
   * component. Selecting a container allows displaying the container editor and the controls used to move the
   * container.
   * Selecting a component automatically unselects the previously selected row or component or tab.
   * @param component the component to select
   * @param event the event, used to prevent the click to propagate to parent elements
   */
  $scope.selectComponent = function (component, event) {
&nbsp;
    $scope.currentContainerRow = null;
    $scope.currentComponent = component;
    if (event) {
      event.stopPropagation();}};
&nbsp;
&nbsp;
&nbsp;
  $scope.deselectComponent = function () {
&nbsp;
    $scope.currentContainerRow = null;
    $scope.currentComponent = null;
    <span class="missing-if-branch" title="if path not taken" >I</span>if (event) {
<span class="cstat-no" title="statement not covered" >      event.stopPropagation();}</span>};
&nbsp;
&nbsp;
&nbsp;
  /**
   * Function used to create a widget component for the given widget and add it to the currently selected container
   * row. A row must be selected before calling this function. Note that the created component keeps a reference to
   * its parent container row, in order to know how to move itself inside this row.
   * @param dragData {type: String, widget: Object}
   * @param index index of the element
   */
  $scope.addComponent = function (dragData, index) {
    var newComponent = dragData.create($scope.currentContainerRow);
    arrays.insertAtPosition(newComponent, index, $scope.currentContainerRow.row);
    componentUtils.column.computeSizeItemInRow($scope.currentContainerRow.row);
    $scope.selectComponent(newComponent);
    newComponent.triggerAdded();};
&nbsp;
&nbsp;
  function removeRow(container, row) {
    var rows = container.rows;
    if (rows.length &gt; 1) {
      var rowIndex = rows.indexOf(row);
      rows.splice(rowIndex, 1);
      whiteboardService.triggerRowRemoved(row);}}
&nbsp;
&nbsp;
&nbsp;
  /**
   * Removes the currently selected row from its container. A row must be selected before calling this function,
   * and it should not be the only one in its container, because a container must always contain at least one row.
   */
  $scope.removeCurrentRow = function () {
    removeRow($scope.currentContainerRow.container, $scope.currentContainerRow.row);
    $scope.currentContainerRow = null;};
&nbsp;
&nbsp;
  /**
   * Removes the currently selected component (widget or container) from its parent row. A component must be selected
   * before calling this function.
   * If a destinationRow is given, it means the component is moved so current row may not have to be deleted
   */
  $scope.removeCurrentComponent = function (item, destinationRow) {
    var component = $scope.currentComponent || item;
    var currentRow = component.$$parentContainerRow.row;
    var componentIndex = currentRow.indexOf(component);
    currentRow.splice(componentIndex, 1);
    if (currentRow.length === 0 &amp;&amp; destinationRow !== currentRow) {
      removeRow(component.$$parentContainerRow.container, currentRow);}
&nbsp;
    if (!destinationRow) {
      component.triggerRemoved();}
&nbsp;
    $scope.currentComponent = null;};
&nbsp;
&nbsp;
  /**
   * Tells if the given row is the currently selected one.
   */
  $scope.isCurrentRow = function (row) {
    return !!$scope.currentContainerRow &amp;&amp; $scope.currentContainerRow.row === row;};
&nbsp;
&nbsp;
  /**
   * Tells if the given component (widget or container) is the currently selected one.
   */
  $scope.isCurrentComponent = function (component) {
    return !!$scope.currentComponent &amp;&amp; $scope.currentComponent === component;};
&nbsp;
&nbsp;
  /**
   * Computes the size of a row by summing its components size.
   * @param row the row to measure
   * @returns {number} the size
   */
  $scope.rowSize = function (row) {
    var size = 0;
    angular.forEach(row, function (component) {
      size += componentUtils.column.width(component);});
&nbsp;
    return size;};
&nbsp;
&nbsp;
  $scope.saveAndEditCustomWidget = function (widgetId) {
    artifactRepo.save($scope.page).
    then(function () {
      $state.go('designer.widget', { 
        id: widgetId });});};
&nbsp;
&nbsp;
&nbsp;
&nbsp;
  $scope.save = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return artifactRepo.save($scope.page);}</span>;
&nbsp;
&nbsp;
  $scope.canBeSaved = function (page) {
    return !!page.name;};
&nbsp;
&nbsp;
  /**
   * Create a nex row at the bottom and add a component
   * @param  {Object} data  a component descriptor to add
   */
  $scope.appendComponent = function (event, data) {
    // we prevent from dropping existing widget
    <span class="missing-if-branch" title="if path not taken" >I</span>if (data.$$widget) {
<span class="cstat-no" title="statement not covered" >      return;}</span>
&nbsp;
    if (!componentUtils.isEmpty($scope.page)) {
      $scope.page.rows.push([]);}
&nbsp;
    var lastRow = $scope.page.rows[$scope.page.rows.length - 1];
    $scope.addComponentToRow(data, $scope.page, lastRow, 0);};
&nbsp;
&nbsp;
  /**
   * Add a component to a row in a container
   * @param {Object} data      Component descriptor
   * @param {Object} container Container that hold the row
   * @param {Array} row        the row where append the component
   * @param {int} index        the index at where we insert the component
   */
  $scope.addComponentToRow = function (data, container, row, index) {
&nbsp;
    $scope.editor.selectRow(container, row);
    $scope.addComponent(data, index);};
&nbsp;
&nbsp;
&nbsp;
  $scope.resizePaletteHandler = <span class="fstat-no" title="function not covered" >function (isClosed, isNarrow) {</span>
<span class="cstat-no" title="statement not covered" >    $scope.isPaletteClosed = isClosed;</span>
<span class="cstat-no" title="statement not covered" >    $scope.isPaletteNarrow = isNarrow;}</span>;
&nbsp;
&nbsp;
  /**
   * Object containing methods helpful for the component and container directives of the editor, and which is passed
   * as an attribute of these directives.
   */
  $scope.editor = { 
    addComponentToRow: $scope.addComponentToRow, 
    selectRow: $scope.selectRow, 
    selectComponent: $scope.selectComponent, 
    deselectComponent: $scope.deselectComponent, 
    dropElement: $scope.dropElement, 
    componentClasses: $scope.componentClasses, 
    removeCurrentRow: $scope.removeCurrentRow, 
    removeCurrentComponent: $scope.removeCurrentComponent, 
    rowSize: $scope.rowSize, 
    isCurrentRow: $scope.isCurrentRow, 
    isCurrentComponent: $scope.isCurrentComponent, 
    moveAtPosition: $scope.moveAtPosition, 
    changeComponentWidth: $scope.changeComponentWidth, 
    getComponentWidth: $scope.getComponentWidth, 
    page: $scope.page };});
//# sourceMappingURL=data:application/json;base64,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QUE0QyxPQUE1QyxFQUFxRCxDQUFyRCxFQUNELENBVkQ7Ozs7Ozs7Ozs7QUFtQkEsU0FBTyxpQkFBUCxHQUEyQixVQUFTLElBQVQsRUFBZSxTQUFmLEVBQTBCLEdBQTFCLEVBQStCLEtBQS9CLEVBQXNDOztBQUUvRCxXQUFPLE1BQVAsQ0FBYyxTQUFkLENBQXdCLFNBQXhCLEVBQW1DLEdBQW5DO0FBQ0EsV0FBTyxZQUFQLENBQW9CLElBQXBCLEVBQTBCLEtBQTFCLEVBRUQsQ0FMRDs7OztBQU9BLFNBQU8sb0JBQVAsR0FBOEIsVUFBUyxRQUFULEVBQW1CLFFBQW5CLEVBQTZCO0FBQ3pELFdBQU8sZUFBUCxHQUF5QixRQUF6QjtBQUNBLFdBQU8sZUFBUCxHQUF5QixRQUF6QixDQUNELENBSEQ7Ozs7Ozs7QUFTQSxTQUFPLE1BQVAsR0FBZ0I7QUFDZCx1QkFBbUIsT0FBTyxpQkFEWjtBQUVkLGVBQVcsT0FBTyxTQUZKO0FBR2QscUJBQWlCLE9BQU8sZUFIVjtBQUlkLHVCQUFtQixPQUFPLGlCQUpaO0FBS2QsaUJBQWEsT0FBTyxXQUxOO0FBTWQsc0JBQWtCLE9BQU8sZ0JBTlg7QUFPZCxzQkFBa0IsT0FBTyxnQkFQWDtBQVFkLDRCQUF3QixPQUFPLHNCQVJqQjtBQVNkLGFBQVMsT0FBTyxPQVRGO0FBVWQsa0JBQWMsT0FBTyxZQVZQO0FBV2Qsd0JBQW9CLE9BQU8sa0JBWGI7QUFZZCxvQkFBZ0IsT0FBTyxjQVpUO0FBYWQsMEJBQXNCLE9BQU8sb0JBYmY7QUFjZCx1QkFBbUIsT0FBTyxpQkFkWjtBQWVkLFVBQU0sT0FBTyxJQWZDLEVBQWhCLENBaUJELENBL1NEIiwiZmlsZSI6ImVkaXRvci5jb250cm9sbGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTUgQm9uaXRhc29mdCBTLkEuXG4gKiBCb25pdGFzb2Z0LCAzMiBydWUgR3VzdGF2ZSBFaWZmZWwgLSAzODAwMCBHcmVub2JsZVxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAyLjAgb2YgdGhlIExpY2Vuc2UsIG9yXG4gKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlXG4gKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uXG4gKi9cbi8qKlxuICogVGhlIGVkaXRvciBjb250cm9sbGVyLiBJdCBoYW5kbGVzIHRoZSBwYWxldHRlLCB0aGUgcmVzb2x1dGlvbiBjaGFuZ2VzLCB0aGUgc2VsZWN0aW9ucywgYW5kIHByb3ZpZGVzXG4gKiBjb21tb24gZnVuY3Rpb25zIHRvIHRoZSBkaXJlY3RpdmVzIHVzZWQgaW5zaWRlIHRoZSBwYWdlLlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdib25pdGFzb2Z0LmRlc2lnbmVyLmVkaXRvcicpLmNvbnRyb2xsZXIoJ0VkaXRvckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkd2luZG93LCBhcnRpZmFjdFJlcG8sIHJlc29sdXRpb25zLCBhcnRpZmFjdCwgbW9kZSwgYXJyYXlzLCBjb21wb25lbnRVdGlscywga2V5bWFzdGVyLCAkdWliTW9kYWwsIHV0aWxzLCB3aGl0ZWJvYXJkU2VydmljZSkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogTmFtZXMgdGhlIGN1cnJlbnQgYnJvd3NpbmcgY29udGV4dFxuICAgKi9cbiAgJHdpbmRvdy5uYW1lID0gJ2VkaXRvcic7XG5cbiAgLyoqXG4gICAqIFRoZSBlZGl0b3IgbW9kZVxuICAgKi9cbiAgJHNjb3BlLm1vZGUgPSBtb2RlIHx8ICdwYWdlJztcbiAgLyoqXG4gICAqIFRoZSByb290IGNvbnRhaW5lciBvZiB0aGUgZWRpdG9yLCBhbHdheXMgcHJlc2VudC4gSWYgdGhlcmUgaXMgbm8gcGFnZSBsb2FkZWQsIHRoZW4gd2UgYnVpbGQgYW4gZW1wdHkgb25lLlxuICAgKiBJdCBpbml0aWFsbHkgY29udGFpbnMgYSBzaW5nbGUgcm93LCBhbmQgbWF5IG5vdCBjb250YWluIGxlc3MgdGhhbiBhIHJvdy4gVGhlIGNvdW50ZXJzIGFyZSB1c2VkIGJ5IGUyZSB0ZXN0cy5cbiAgICovXG4gICRzY29wZS5wYWdlID0gYXJ0aWZhY3Q7XG5cbiAgJHNjb3BlLnJlc29sdXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gcmVzb2x1dGlvbnMuc2VsZWN0ZWQoKTtcbiAgfTtcblxuICAvKipcbiAgICogQWRkaW5nIERFTCBrZXlib2FyZCBzaG9ydGN1dFxuICAgKi9cbiAga2V5bWFzdGVyKCdkZWwnLCBmdW5jdGlvbigpIHtcbiAgICBpZiAoISRzY29wZS5jdXJyZW50Q29tcG9uZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5yZW1vdmVDdXJyZW50Q29tcG9uZW50KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGtleW1hc3RlcigncmlnaHQnLCBmdW5jdGlvbigpIHtcbiAgICBtb3ZlU2VsZWN0aW9uKCsxKTtcbiAgfSk7XG5cbiAga2V5bWFzdGVyKCdsZWZ0JywgZnVuY3Rpb24oKSB7XG4gICAgbW92ZVNlbGVjdGlvbigtMSk7XG4gIH0pO1xuXG4gIGtleW1hc3RlcignY3RybCtzJywgZnVuY3Rpb24oKSB7XG4gICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5zYXZlKCk7XG4gICAgfSk7XG4gICAgLy8gcHJldmVudCBkZWZhdWx0IGJyb3dzZXIgYWN0aW9uXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcblxuICBmdW5jdGlvbiBtb3ZlU2VsZWN0aW9uKG9mZnNldCkge1xuICAgIHZhciBjb21wb25lbnRzID0gY29tcG9uZW50VXRpbHMuZ2V0VmlzaWJsZUNvbXBvbmVudHMoJHNjb3BlLnBhZ2UpO1xuICAgIHZhciBpbmRleCA9IGNvbXBvbmVudHMuaW5kZXhPZigkc2NvcGUuY3VycmVudENvbXBvbmVudCkgKyBvZmZzZXQ7XG5cbiAgICBpbmRleCA9IHV0aWxzLmNsYW1wKDAsIGluZGV4LCBjb21wb25lbnRzLmxlbmd0aCAtIDEpO1xuXG4gICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5zZWxlY3RDb21wb25lbnQoY29tcG9uZW50c1tpbmRleF0pO1xuICAgIH0pO1xuICB9XG5cbiAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICBrZXltYXN0ZXIudW5iaW5kKCdkZWwnKTtcbiAgICBrZXltYXN0ZXIudW5iaW5kKCdyaWdodCcpO1xuICAgIGtleW1hc3Rlci51bmJpbmQoJ2xlZnQnKTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIENTUyBjbGFzc2VzIHRoYXQgbXVzdCBiZSBzZXQgb24gYSBjb21wb25lbnQgaW4gdGhlIGVkaXRvciB0byByZWZsZWN0IGl0cyB3aWR0aCBhbmQgdGhlIGN1cnJlbnRseVxuICAgKiBzZWxlY3RlZCByZXNvbHV0aW9uLiBJdCByZXR1cm5zIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIGNvbHVtbkNsYXNzIG9mIHRoZSBjb21wb25lbnQsIGFzIHdlbGwgYXNcbiAgICogY29tcG9uZW50LXNlbGVjdGVkIGlmIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBpcyB0aGUgZ2l2ZW4gY29tcG9uZW50LlxuICAgKiBOb3RlIHRoYXQgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgZm9yIGEgY29tcG9uZW50IG9mIHR5cGUgJ3dpZGdldCcgb3Igb2YgdHlwZSAnY29udGFpbmVyJy5cbiAgICovXG4gICRzY29wZS5jb21wb25lbnRDbGFzc2VzID0gZnVuY3Rpb24oY29tcG9uZW50KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtjb21wb25lbnRVdGlscy5jb2x1bW4uY2xhc3NOYW1lKGNvbXBvbmVudCldO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvKipcbiAgICogRnVuY3Rpb24gY2FsbGVkIHdoZW4gd2Ugd2FudCB0aGUgY3VycmVudCBzZWxlY3Rpb24gdG8gYmUgYSByb3cgb2YgYSBjb250YWluZXIuIFNlbGVjdGluZyBhIHJvdyBvZiBhIGNvbnRhaW5lclxuICAgKiBhbGxvd3MgZGlzcGxheWluZyB0aGUgcGFsZXR0ZSwgaW4gb3JkZXIgdG8gYWRkIGEgd2lkZ2V0IG9yIGNvbnRhaW5lciBjb21wb25lbnQgdG8gdGhlIHNlbGVjdGVkIHJvdywgdG8gZGVsZXRlXG4gICAqIG9yIG1vdmUgdGhlIHNlbGVjdGVkIHJvdywgb3IgdG8gYWRkIGEgbmV3IHJvdyBiZWZvcmUgb3IgYWZ0ZXIgdGhlIHNlbGVjdGVkIHJvdy5cbiAgICogU2VsZWN0aW5nIGEgcm93IGF1dG9tYXRpY2FsbHkgdW5zZWxlY3RzIHRoZSBwcmV2aW91c2x5IHNlbGVjdGVkIHJvdyBvciBjb21wb25lbnQgb3IgdGFiLlxuICAgKiBAcGFyYW0gY29udGFpbmVyIHRoZSBjb250YWluZXIgZGlyZWN0bHkgY29udGFpbmluZyB0aGUgcm93IHRvIHNlbGVjdFxuICAgKiBAcGFyYW0gcm93IHRoZSByb3cgdG8gc2VsZWN0XG4gICAqIEBwYXJhbSBldmVudCB0aGUgZXZlbnQsIHVzZWQgdG8gcHJldmVudCB0aGUgY2xpY2sgdG8gcHJvcGFnYXRlIHRvIHBhcmVudCBlbGVtZW50c1xuICAgKi9cbiAgJHNjb3BlLnNlbGVjdFJvdyA9IGZ1bmN0aW9uKGNvbnRhaW5lciwgcm93LCBldmVudCkge1xuXG4gICAgJHNjb3BlLmN1cnJlbnRDb21wb25lbnQgPSBudWxsO1xuICAgICRzY29wZS5jdXJyZW50Q29udGFpbmVyUm93ID0ge1xuICAgICAgcm93OiByb3csXG4gICAgICBjb250YWluZXI6IGNvbnRhaW5lclxuICAgIH07XG4gICAgaWYgKGV2ZW50KSB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIERyYWcgYW5kIGRyb3AgYW4gaXRlbSwgaXQgbWVhbnMgcmUtYXR0YWNoIHRoaXMgaXRlbVxuICAgKiBAcGFyYW0gIHtPYmplY3R9IGVsZW1lbnQgV2lkZ2V0IGFscmVhZHkgY29uZmlndXJlZFxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgJHNjb3BlLmRyb3BFbGVtZW50ID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICRzY29wZS5jdXJyZW50Q29tcG9uZW50ID0gZWxlbWVudDtcbiAgICBlbGVtZW50LiQkcGFyZW50Q29udGFpbmVyUm93ID0gJHNjb3BlLmN1cnJlbnRDb250YWluZXJSb3c7XG4gICAgJHNjb3BlLmN1cnJlbnRDb250YWluZXJSb3cucm93LnB1c2goZWxlbWVudCk7XG4gICAgY29tcG9uZW50VXRpbHMuY29sdW1uLmNvbXB1dGVTaXplSXRlbUluUm93KCRzY29wZS5jdXJyZW50Q29udGFpbmVyUm93LnJvdyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIG1vdmUgYSBjb21wb25lbnQgdG8gYSBzcGVjaWZpYyBwb3NpdGlvbiBpbnNpZGUgdGhlIGN1cnJlbnQgYWN0aXZlIHJvd1xuICAgKiBAcGFyYW0gIHtpbnR9ICAgIGNvbXBvbmVudEluZGV4IG5ldyBpbmRleCBmb3IgY29tcG9uZW50XG4gICAqIEBwYXJhbSAge09iamVjdH0gY29tcG9uZW50ICAgICAgYSBjb21wb25lbnRcbiAgICovXG4gICRzY29wZS5tb3ZlQXRQb3NpdGlvbiA9IGZ1bmN0aW9uKGNvbXBvbmVudEluZGV4LCBjb21wb25lbnQpIHtcbiAgICBhcnJheXMubW92ZUF0UG9zaXRpb24oY29tcG9uZW50LCBjb21wb25lbnRJbmRleCwgJHNjb3BlLmN1cnJlbnRDb250YWluZXJSb3cucm93KTtcbiAgICAkc2NvcGUuc2VsZWN0Q29tcG9uZW50KGNvbXBvbmVudCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIHdlIHdhbnQgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHRvIGJlIGEgd2lkZ2V0IGNvbXBvbmVudCBvciBhIGNvbnRhaW5lciBjb21wb25lbnQuIFNlbGVjdGluZ1xuICAgKiBhIHdpZGdldCBjb21wb25lbnQgYWxsb3dzIGRpc3BsYXlpbmcgdGhlIGVkaXRvciBmb3IgdGhpcyB3aWRnZXQgY29tcG9uZW50LCBhbmQgdGhlIGNvbnRyb2xzIHVzZWQgdG8gbW92ZSB0aGVcbiAgICogY29tcG9uZW50LiBTZWxlY3RpbmcgYSBjb250YWluZXIgYWxsb3dzIGRpc3BsYXlpbmcgdGhlIGNvbnRhaW5lciBlZGl0b3IgYW5kIHRoZSBjb250cm9scyB1c2VkIHRvIG1vdmUgdGhlXG4gICAqIGNvbnRhaW5lci5cbiAgICogU2VsZWN0aW5nIGEgY29tcG9uZW50IGF1dG9tYXRpY2FsbHkgdW5zZWxlY3RzIHRoZSBwcmV2aW91c2x5IHNlbGVjdGVkIHJvdyBvciBjb21wb25lbnQgb3IgdGFiLlxuICAgKiBAcGFyYW0gY29tcG9uZW50IHRoZSBjb21wb25lbnQgdG8gc2VsZWN0XG4gICAqIEBwYXJhbSBldmVudCB0aGUgZXZlbnQsIHVzZWQgdG8gcHJldmVudCB0aGUgY2xpY2sgdG8gcHJvcGFnYXRlIHRvIHBhcmVudCBlbGVtZW50c1xuICAgKi9cbiAgJHNjb3BlLnNlbGVjdENvbXBvbmVudCA9IGZ1bmN0aW9uKGNvbXBvbmVudCwgZXZlbnQpIHtcblxuICAgICRzY29wZS5jdXJyZW50Q29udGFpbmVyUm93ID0gbnVsbDtcbiAgICAkc2NvcGUuY3VycmVudENvbXBvbmVudCA9IGNvbXBvbmVudDtcbiAgICBpZiAoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cbiAgfTtcblxuICAkc2NvcGUuZGVzZWxlY3RDb21wb25lbnQgPSBmdW5jdGlvbigpIHtcblxuICAgICRzY29wZS5jdXJyZW50Q29udGFpbmVyUm93ID0gbnVsbDtcbiAgICAkc2NvcGUuY3VycmVudENvbXBvbmVudCA9IG51bGw7XG4gICAgaWYgKGV2ZW50KSB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEZ1bmN0aW9uIHVzZWQgdG8gY3JlYXRlIGEgd2lkZ2V0IGNvbXBvbmVudCBmb3IgdGhlIGdpdmVuIHdpZGdldCBhbmQgYWRkIGl0IHRvIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgY29udGFpbmVyXG4gICAqIHJvdy4gQSByb3cgbXVzdCBiZSBzZWxlY3RlZCBiZWZvcmUgY2FsbGluZyB0aGlzIGZ1bmN0aW9uLiBOb3RlIHRoYXQgdGhlIGNyZWF0ZWQgY29tcG9uZW50IGtlZXBzIGEgcmVmZXJlbmNlIHRvXG4gICAqIGl0cyBwYXJlbnQgY29udGFpbmVyIHJvdywgaW4gb3JkZXIgdG8ga25vdyBob3cgdG8gbW92ZSBpdHNlbGYgaW5zaWRlIHRoaXMgcm93LlxuICAgKiBAcGFyYW0gZHJhZ0RhdGEge3R5cGU6IFN0cmluZywgd2lkZ2V0OiBPYmplY3R9XG4gICAqIEBwYXJhbSBpbmRleCBpbmRleCBvZiB0aGUgZWxlbWVudFxuICAgKi9cbiAgJHNjb3BlLmFkZENvbXBvbmVudCA9IGZ1bmN0aW9uKGRyYWdEYXRhLCBpbmRleCkge1xuICAgIHZhciBuZXdDb21wb25lbnQgPSBkcmFnRGF0YS5jcmVhdGUoJHNjb3BlLmN1cnJlbnRDb250YWluZXJSb3cpO1xuICAgIGFycmF5cy5pbnNlcnRBdFBvc2l0aW9uKG5ld0NvbXBvbmVudCwgaW5kZXgsICRzY29wZS5jdXJyZW50Q29udGFpbmVyUm93LnJvdyk7XG4gICAgY29tcG9uZW50VXRpbHMuY29sdW1uLmNvbXB1dGVTaXplSXRlbUluUm93KCRzY29wZS5jdXJyZW50Q29udGFpbmVyUm93LnJvdyk7XG4gICAgJHNjb3BlLnNlbGVjdENvbXBvbmVudChuZXdDb21wb25lbnQpO1xuICAgIG5ld0NvbXBvbmVudC50cmlnZ2VyQWRkZWQoKTtcbiAgfTtcblxuICBmdW5jdGlvbiByZW1vdmVSb3coY29udGFpbmVyLCByb3cpIHtcbiAgICB2YXIgcm93cyA9IGNvbnRhaW5lci5yb3dzO1xuICAgIGlmIChyb3dzLmxlbmd0aCA+IDEpIHtcbiAgICAgIHZhciByb3dJbmRleCA9IHJvd3MuaW5kZXhPZihyb3cpO1xuICAgICAgcm93cy5zcGxpY2Uocm93SW5kZXgsIDEpO1xuICAgICAgd2hpdGVib2FyZFNlcnZpY2UudHJpZ2dlclJvd1JlbW92ZWQocm93KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHJvdyBmcm9tIGl0cyBjb250YWluZXIuIEEgcm93IG11c3QgYmUgc2VsZWN0ZWQgYmVmb3JlIGNhbGxpbmcgdGhpcyBmdW5jdGlvbixcbiAgICogYW5kIGl0IHNob3VsZCBub3QgYmUgdGhlIG9ubHkgb25lIGluIGl0cyBjb250YWluZXIsIGJlY2F1c2UgYSBjb250YWluZXIgbXVzdCBhbHdheXMgY29udGFpbiBhdCBsZWFzdCBvbmUgcm93LlxuICAgKi9cbiAgJHNjb3BlLnJlbW92ZUN1cnJlbnRSb3cgPSBmdW5jdGlvbigpIHtcbiAgICByZW1vdmVSb3coJHNjb3BlLmN1cnJlbnRDb250YWluZXJSb3cuY29udGFpbmVyLCAkc2NvcGUuY3VycmVudENvbnRhaW5lclJvdy5yb3cpO1xuICAgICRzY29wZS5jdXJyZW50Q29udGFpbmVyUm93ID0gbnVsbDtcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlcyB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGNvbXBvbmVudCAod2lkZ2V0IG9yIGNvbnRhaW5lcikgZnJvbSBpdHMgcGFyZW50IHJvdy4gQSBjb21wb25lbnQgbXVzdCBiZSBzZWxlY3RlZFxuICAgKiBiZWZvcmUgY2FsbGluZyB0aGlzIGZ1bmN0aW9uLlxuICAgKiBJZiBhIGRlc3RpbmF0aW9uUm93IGlzIGdpdmVuLCBpdCBtZWFucyB0aGUgY29tcG9uZW50IGlzIG1vdmVkIHNvIGN1cnJlbnQgcm93IG1heSBub3QgaGF2ZSB0byBiZSBkZWxldGVkXG4gICAqL1xuICAkc2NvcGUucmVtb3ZlQ3VycmVudENvbXBvbmVudCA9IGZ1bmN0aW9uKGl0ZW0sIGRlc3RpbmF0aW9uUm93KSB7XG4gICAgdmFyIGNvbXBvbmVudCA9ICRzY29wZS5jdXJyZW50Q29tcG9uZW50IHx8IGl0ZW07XG4gICAgdmFyIGN1cnJlbnRSb3cgPSBjb21wb25lbnQuJCRwYXJlbnRDb250YWluZXJSb3cucm93O1xuICAgIHZhciBjb21wb25lbnRJbmRleCA9IGN1cnJlbnRSb3cuaW5kZXhPZihjb21wb25lbnQpO1xuICAgIGN1cnJlbnRSb3cuc3BsaWNlKGNvbXBvbmVudEluZGV4LCAxKTtcbiAgICBpZiAoY3VycmVudFJvdy5sZW5ndGggPT09IDAgJiYgZGVzdGluYXRpb25Sb3cgIT09IGN1cnJlbnRSb3cpIHtcbiAgICAgIHJlbW92ZVJvdyhjb21wb25lbnQuJCRwYXJlbnRDb250YWluZXJSb3cuY29udGFpbmVyLCBjdXJyZW50Um93KTtcbiAgICB9XG4gICAgaWYgKCFkZXN0aW5hdGlvblJvdykge1xuICAgICAgY29tcG9uZW50LnRyaWdnZXJSZW1vdmVkKCk7XG4gICAgfVxuICAgICRzY29wZS5jdXJyZW50Q29tcG9uZW50ID0gbnVsbDtcbiAgfTtcblxuICAvKipcbiAgICogVGVsbHMgaWYgdGhlIGdpdmVuIHJvdyBpcyB0aGUgY3VycmVudGx5IHNlbGVjdGVkIG9uZS5cbiAgICovXG4gICRzY29wZS5pc0N1cnJlbnRSb3cgPSBmdW5jdGlvbihyb3cpIHtcbiAgICByZXR1cm4gISEkc2NvcGUuY3VycmVudENvbnRhaW5lclJvdyAmJiAkc2NvcGUuY3VycmVudENvbnRhaW5lclJvdy5yb3cgPT09IHJvdztcbiAgfTtcblxuICAvKipcbiAgICogVGVsbHMgaWYgdGhlIGdpdmVuIGNvbXBvbmVudCAod2lkZ2V0IG9yIGNvbnRhaW5lcikgaXMgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBvbmUuXG4gICAqL1xuICAkc2NvcGUuaXNDdXJyZW50Q29tcG9uZW50ID0gZnVuY3Rpb24oY29tcG9uZW50KSB7XG4gICAgcmV0dXJuICEhJHNjb3BlLmN1cnJlbnRDb21wb25lbnQgJiYgJHNjb3BlLmN1cnJlbnRDb21wb25lbnQgPT09IGNvbXBvbmVudDtcbiAgfTtcblxuICAvKipcbiAgICogQ29tcHV0ZXMgdGhlIHNpemUgb2YgYSByb3cgYnkgc3VtbWluZyBpdHMgY29tcG9uZW50cyBzaXplLlxuICAgKiBAcGFyYW0gcm93IHRoZSByb3cgdG8gbWVhc3VyZVxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgc2l6ZVxuICAgKi9cbiAgJHNjb3BlLnJvd1NpemUgPSBmdW5jdGlvbihyb3cpIHtcbiAgICB2YXIgc2l6ZSA9IDA7XG4gICAgYW5ndWxhci5mb3JFYWNoKHJvdywgZnVuY3Rpb24oY29tcG9uZW50KSB7XG4gICAgICBzaXplICs9IGNvbXBvbmVudFV0aWxzLmNvbHVtbi53aWR0aChjb21wb25lbnQpO1xuICAgIH0pO1xuICAgIHJldHVybiBzaXplO1xuICB9O1xuXG4gICRzY29wZS5zYXZlQW5kRWRpdEN1c3RvbVdpZGdldCA9IGZ1bmN0aW9uKHdpZGdldElkKSB7XG4gICAgYXJ0aWZhY3RSZXBvLnNhdmUoJHNjb3BlLnBhZ2UpXG4gICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdkZXNpZ25lci53aWRnZXQnLCB7XG4gICAgICAgICAgaWQ6IHdpZGdldElkXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gIH07XG5cbiAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gYXJ0aWZhY3RSZXBvLnNhdmUoJHNjb3BlLnBhZ2UpO1xuICB9O1xuXG4gICRzY29wZS5jYW5CZVNhdmVkID0gZnVuY3Rpb24ocGFnZSkge1xuICAgIHJldHVybiAhIXBhZ2UubmFtZTtcbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV4IHJvdyBhdCB0aGUgYm90dG9tIGFuZCBhZGQgYSBjb21wb25lbnRcbiAgICogQHBhcmFtICB7T2JqZWN0fSBkYXRhICBhIGNvbXBvbmVudCBkZXNjcmlwdG9yIHRvIGFkZFxuICAgKi9cbiAgJHNjb3BlLmFwcGVuZENvbXBvbmVudCA9IGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XG4gICAgLy8gd2UgcHJldmVudCBmcm9tIGRyb3BwaW5nIGV4aXN0aW5nIHdpZGdldFxuICAgIGlmIChkYXRhLiQkd2lkZ2V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghY29tcG9uZW50VXRpbHMuaXNFbXB0eSgkc2NvcGUucGFnZSkpIHtcbiAgICAgICRzY29wZS5wYWdlLnJvd3MucHVzaChbXSk7XG4gICAgfVxuICAgIHZhciBsYXN0Um93ID0gJHNjb3BlLnBhZ2Uucm93c1skc2NvcGUucGFnZS5yb3dzLmxlbmd0aCAtIDFdO1xuICAgICRzY29wZS5hZGRDb21wb25lbnRUb1JvdyhkYXRhLCAkc2NvcGUucGFnZSwgbGFzdFJvdywgMCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBhIGNvbXBvbmVudCB0byBhIHJvdyBpbiBhIGNvbnRhaW5lclxuICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAgICAgIENvbXBvbmVudCBkZXNjcmlwdG9yXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBjb250YWluZXIgQ29udGFpbmVyIHRoYXQgaG9sZCB0aGUgcm93XG4gICAqIEBwYXJhbSB7QXJyYXl9IHJvdyAgICAgICAgdGhlIHJvdyB3aGVyZSBhcHBlbmQgdGhlIGNvbXBvbmVudFxuICAgKiBAcGFyYW0ge2ludH0gaW5kZXggICAgICAgIHRoZSBpbmRleCBhdCB3aGVyZSB3ZSBpbnNlcnQgdGhlIGNvbXBvbmVudFxuICAgKi9cbiAgJHNjb3BlLmFkZENvbXBvbmVudFRvUm93ID0gZnVuY3Rpb24oZGF0YSwgY29udGFpbmVyLCByb3csIGluZGV4KSB7XG5cbiAgICAkc2NvcGUuZWRpdG9yLnNlbGVjdFJvdyhjb250YWluZXIsIHJvdyk7XG4gICAgJHNjb3BlLmFkZENvbXBvbmVudChkYXRhLCBpbmRleCk7XG5cbiAgfTtcblxuICAkc2NvcGUucmVzaXplUGFsZXR0ZUhhbmRsZXIgPSBmdW5jdGlvbihpc0Nsb3NlZCwgaXNOYXJyb3cpIHtcbiAgICAkc2NvcGUuaXNQYWxldHRlQ2xvc2VkID0gaXNDbG9zZWQ7XG4gICAgJHNjb3BlLmlzUGFsZXR0ZU5hcnJvdyA9IGlzTmFycm93O1xuICB9O1xuXG4gIC8qKlxuICAgKiBPYmplY3QgY29udGFpbmluZyBtZXRob2RzIGhlbHBmdWwgZm9yIHRoZSBjb21wb25lbnQgYW5kIGNvbnRhaW5lciBkaXJlY3RpdmVzIG9mIHRoZSBlZGl0b3IsIGFuZCB3aGljaCBpcyBwYXNzZWRcbiAgICogYXMgYW4gYXR0cmlidXRlIG9mIHRoZXNlIGRpcmVjdGl2ZXMuXG4gICAqL1xuICAkc2NvcGUuZWRpdG9yID0ge1xuICAgIGFkZENvbXBvbmVudFRvUm93OiAkc2NvcGUuYWRkQ29tcG9uZW50VG9Sb3csXG4gICAgc2VsZWN0Um93OiAkc2NvcGUuc2VsZWN0Um93LFxuICAgIHNlbGVjdENvbXBvbmVudDogJHNjb3BlLnNlbGVjdENvbXBvbmVudCxcbiAgICBkZXNlbGVjdENvbXBvbmVudDogJHNjb3BlLmRlc2VsZWN0Q29tcG9uZW50LFxuICAgIGRyb3BFbGVtZW50OiAkc2NvcGUuZHJvcEVsZW1lbnQsXG4gICAgY29tcG9uZW50Q2xhc3NlczogJHNjb3BlLmNvbXBvbmVudENsYXNzZXMsXG4gICAgcmVtb3ZlQ3VycmVudFJvdzogJHNjb3BlLnJlbW92ZUN1cnJlbnRSb3csXG4gICAgcmVtb3ZlQ3VycmVudENvbXBvbmVudDogJHNjb3BlLnJlbW92ZUN1cnJlbnRDb21wb25lbnQsXG4gICAgcm93U2l6ZTogJHNjb3BlLnJvd1NpemUsXG4gICAgaXNDdXJyZW50Um93OiAkc2NvcGUuaXNDdXJyZW50Um93LFxuICAgIGlzQ3VycmVudENvbXBvbmVudDogJHNjb3BlLmlzQ3VycmVudENvbXBvbmVudCxcbiAgICBtb3ZlQXRQb3NpdGlvbjogJHNjb3BlLm1vdmVBdFBvc2l0aW9uLFxuICAgIGNoYW5nZUNvbXBvbmVudFdpZHRoOiAkc2NvcGUuY2hhbmdlQ29tcG9uZW50V2lkdGgsXG4gICAgZ2V0Q29tcG9uZW50V2lkdGg6ICRzY29wZS5nZXRDb21wb25lbnRXaWR0aCxcbiAgICBwYWdlOiAkc2NvcGUucGFnZVxuICB9O1xufSk7XG4iXX0=</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Jun 28 2016 07:45:53 GMT+0530 (IST)</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
